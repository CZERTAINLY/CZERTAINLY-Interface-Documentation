openapi: 3.0.1
info:
  title: CZERTAINLY Administrator API
  description: REST API for managing Administrators in the platform
  contact:
    name: CZERTAINLY
    url: https://www.czertainly.com
    email: getinfo@czertainly.com
  license:
    name: MIT License
    url: https://github.com/3KeyCompany/CZERTAINLY/blob/develop/LICENSE.md
  x-logo:
    url: images/czertainly_color_H.svg
externalDocs:
  description: CZERTAINLY Documentation
  url: https://docs.czertainly.com
servers:
- url: http://localhost:8080
  description: Generated server url
tags:
- name: Admin Management API
  description: "Admin Management API. Provides to Information regarding the Administrators\
    \ in the platform With the Admin API, operations like addition, removal, enable\
    \ etc... operations can be performed "
paths:
  /v1/admins/{uuid}/enable:
    put:
      tags:
      - Admin Management API
      summary: Enable Administrator
      operationId: enableAdmin
      parameters:
      - name: uuid
        in: path
        required: true
        schema:
          type: string
      responses:
        "200":
          description: Enable administrator success
        "400":
          description: Invalid request
        "404":
          description: Not found
  /v1/admins/{uuid}/disable:
    put:
      tags:
      - Admin Management API
      summary: Disable Administrator
      operationId: disableAdmin
      parameters:
      - name: uuid
        in: path
        required: true
        schema:
          type: string
      responses:
        "200":
          description: Disable administrator success
        "400":
          description: Invalid request
        "404":
          description: Not found
  /v1/admins/enable:
    put:
      tags:
      - Admin Management API
      summary: Enable Multiple Administrator
      operationId: bulkEnableAdmin
      requestBody:
        content:
          application/json:
            schema:
              type: array
              items:
                type: string
        required: true
      responses:
        "204":
          description: Enable administrator success
        "400":
          description: Invalid request
        "404":
          description: Not found
  /v1/admins/disable:
    put:
      tags:
      - Admin Management API
      summary: Disable Multiple Administrator
      operationId: bulkDisableAdmin
      requestBody:
        content:
          application/json:
            schema:
              type: array
              items:
                type: string
        required: true
      responses:
        "400":
          description: Invalid request
        "404":
          description: Not found
        "204":
          description: Disable administrator success
  /v1/admins/{uuid}:
    get:
      tags:
      - Admin Management API
      summary: Get details of an Administrator
      operationId: getAdmin
      parameters:
      - name: uuid
        in: path
        required: true
        schema:
          type: string
      responses:
        "200":
          description: Administrator details retrieved
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AdminDto'
        "400":
          description: Invalid request
        "404":
          description: Not found
    post:
      tags:
      - Admin Management API
      summary: Edit Administrator
      operationId: editAdmin
      parameters:
      - name: uuid
        in: path
        required: true
        schema:
          type: string
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/EditAdminRequestDto'
        required: true
      responses:
        "200":
          description: Administrator edit success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AdminDto'
        "400":
          description: Invalid request
        "404":
          description: Not found
    delete:
      tags:
      - Admin Management API
      summary: Remove Administrator
      operationId: removeAdmin
      parameters:
      - name: uuid
        in: path
        required: true
        schema:
          type: string
      responses:
        "400":
          description: Invalid request
        "404":
          description: Not found
        "204":
          description: Administrator removed
  /v1/admins:
    get:
      tags:
      - Admin Management API
      summary: List available administrators
      operationId: listAdmins
      responses:
        "200":
          description: List of administrator
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/AdminDto'
        "400":
          description: Invalid request
        "404":
          description: Not found
    post:
      tags:
      - Admin Management API
      summary: Create a new Administrators
      operationId: addAdmin
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AddAdminRequestDto'
        required: true
      responses:
        "400":
          description: Invalid request
        "404":
          description: Not found
        "422":
          description: Unprocessable Entity
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ValidationException'
        "201":
          description: New administrator created
          content:
            application/json:
              schema:
                type: object
    delete:
      tags:
      - Admin Management API
      summary: Remove Multiple Administrator
      operationId: bulkRemoveAdmin
      requestBody:
        content:
          application/json:
            schema:
              type: array
              items:
                type: string
        required: true
      responses:
        "400":
          description: Invalid request
        "404":
          description: Not found
        "204":
          description: Administrator removed
components:
  schemas:
    EditAdminRequestDto:
      required:
      - certificateUuid
      - description
      - email
      - name
      - role
      - surname
      type: object
      properties:
        adminCertificate:
          type: string
          description: Base64 Content of the certificate
        certificateUuid:
          type: string
          description: UUID of the existing certificate in inventory
        name:
          type: string
          description: Name of the administrator
        surname:
          type: string
          description: Administrator Surname
        email:
          type: string
          description: Email Id of the admin
        role:
          type: string
          description: Role of the admin
          enum:
          - ADMINISTRATOR
          - SUPERADMINISTRATOR
        description:
          type: string
          description: Description for the administrator
    AdminDto:
      required:
      - certificate
      - description
      - email
      - enabled
      - id
      - name
      - role
      - serialNumber
      - surname
      - username
      - uuid
      type: object
      properties:
        id:
          type: integer
          description: Id of the Administrator
          format: int64
        uuid:
          type: string
          description: UUID of the Administrator
        username:
          type: string
          description: Administrator Username
        certificate:
          $ref: '#/components/schemas/CertificateDto'
        role:
          type: string
          description: Role of the administrator
          enum:
          - ADMINISTRATOR
          - SUPERADMINISTRATOR
        email:
          type: string
          description: Administrator Email
        serialNumber:
          type: string
          description: Serial Number of the administrator
        name:
          type: string
          description: Username of the administrator
        description:
          type: string
          description: Administrator description
        enabled:
          type: boolean
          description: Is the admin enabled?
        surname:
          type: string
          description: Surname of administrator
    AttributeCallback:
      required:
      - callbackContext
      - callbackMethod
      - mappings
      type: object
      properties:
        callbackContext:
          type: string
          description: Context part of callback URL
        callbackMethod:
          type: string
          description: HTTP method of the callback
        mappings:
          uniqueItems: true
          type: array
          description: Mappings for the callback method
          items:
            $ref: '#/components/schemas/AttributeCallbackMapping'
        pathVariables:
          type: object
          additionalProperties:
            type: object
            description: Map of path variables supported by the callback method
          description: Map of path variables supported by the callback method
        queryParameters:
          type: object
          additionalProperties:
            type: object
            description: Map of the query parameters supported by the callback method
          description: Map of the query parameters supported by the callback method
        requestBody:
          type: object
          additionalProperties:
            type: object
            description: Request body for the callback method
          description: Request body for the callback method
      description: Optional definition of callback for helper methods
    AttributeCallbackMapping:
      required:
      - targets
      - to
      type: object
      properties:
        from:
          type: string
          description: Name of the attribute whose value is to be used as value of
            path variable or request param or body field.It is optional and must be
            set only if value is not set.
        attributeType:
          type: string
          description: Type of the attribute. It is optional and must be set only
            if special behaviour is needed.
          enum:
          - STRING
          - SECRET
          - FILE
          - BOOLEAN
          - LIST
          - CREDENTIAL
        to:
          type: string
          description: Name of the path variable or request param or body field which
            is to be used to assign value of attribute
        targets:
          uniqueItems: true
          type: array
          description: Set of targets for propagating value.
          items:
            type: string
            description: Set of targets for propagating value.
            enum:
            - PATH_VARIABLE
            - REQUEST_PARAMETER
            - BODY
        value:
          type: object
          description: Static value to be propagated to targets. It is optional and
            is set only if the value is known at attribute creation time.
      description: Mappings for the callback method
    AttributeDefinition:
      required:
      - editable
      - label
      - multiValue
      - name
      - readOnly
      - required
      - type
      - uuid
      - visible
      type: object
      properties:
        uuid:
          type: string
          description: UUID of the Attribute
          example: 166b5cf52-63f2-11ec-90d6-0242ac120003
        name:
          type: string
          description: Name of the Attribute
          example: Attribute
        label:
          type: string
          description: Label of the the Attribute
          example: Attribute Name
        type:
          type: string
          description: Type of the Attribute
          enum:
          - STRING
          - SECRET
          - FILE
          - BOOLEAN
          - LIST
          - CREDENTIAL
        required:
          type: boolean
          description: Boolean determining if the Attribute is required
          default: false
        readOnly:
          type: boolean
          description: Boolean determining if the Attribute is read only
          default: false
        editable:
          type: boolean
          description: Boolean determining if the Attribute is editable
          default: true
        visible:
          type: boolean
          description: Boolean determining if the Attribute is visible and can be
            displayed
          default: true
        multiValue:
          type: boolean
          description: Boolean determining if the Attribute has value composed from
            multiple items
          default: false
        description:
          type: string
          description: "Optional description of the Attribute, should contain help\
            \ for setting proper value"
        validationRegex:
          type: string
          description: Optional regular expression used for validating the Attribute
            value
        dependsOn:
          type: array
          description: Optional list of other Attribute names and values on which
            it depends on
          items:
            $ref: '#/components/schemas/AttributeDependency'
        attributeCallback:
          $ref: '#/components/schemas/AttributeCallback'
        value:
          type: object
          description: Value of the Attribute
      description: List of RA Profiles attributes
    AttributeDependency:
      required:
      - name
      - value
      type: object
      properties:
        name:
          type: string
          description: Name of depending attribute
        value:
          type: object
          description: "Value of depending attribute, which should be matched"
      description: Optional list of other Attribute names and values on which it depends
        on
    CertificateDto:
      required:
      - basicConstraints
      - certificateContent
      - commonName
      - fingerprint
      - issuerCommonName
      - issuerDn
      - keySize
      - keyUsage
      - notAfter
      - notBefore
      - publicKeyAlgorithm
      - serialNumber
      - signatureAlgorithm
      - status
      - subjectDn
      - uuid
      type: object
      properties:
        uuid:
          type: string
          description: UUID of the Certificate
        commonName:
          type: string
          description: Certificate common name
        serialNumber:
          type: string
          description: Certificate serial number
        issuerCommonName:
          type: string
          description: Certificate issuer common name
        certificateContent:
          type: string
          description: Base64 encoded Certificate content
        issuerDn:
          type: string
          description: Issuer DN of the Certificate
        subjectDn:
          type: string
          description: Subject DN of the Certificate
        notBefore:
          type: string
          description: Certificate validity start date
          format: date-time
        notAfter:
          type: string
          description: Certificate expiration date
          format: date-time
        publicKeyAlgorithm:
          type: string
          description: Public key algorithm
        signatureAlgorithm:
          type: string
          description: Certificate signature algorithm
        keySize:
          type: integer
          description: Certificate key size
          format: int32
        extendedKeyUsage:
          type: array
          description: Extended key usages
          items:
            type: string
            description: Extended key usages
        keyUsage:
          type: array
          description: Key usages
          items:
            type: string
            description: Key usages
        basicConstraints:
          type: string
          description: Basic Constraints
        meta:
          type: object
          additionalProperties:
            type: object
            description: Certificate meta data
          description: Certificate meta data
        status:
          type: string
          description: Status of the Certificate
          enum:
          - VALID
          - REVOKED
          - EXPIRED
          - UNKNOWN
          - EXPIRING
          - NEW
          - INVALID
        raProfile:
          $ref: '#/components/schemas/RaProfileDto'
        fingerprint:
          type: string
          description: SHA256 fingerprint of the Certificate
        subjectAlternativeNames:
          type: object
          additionalProperties:
            type: object
            description: Subject alternative names
          description: Subject alternative names
        entity:
          $ref: '#/components/schemas/CertificateEntityDto'
        group:
          $ref: '#/components/schemas/CertificateGroupDto'
        owner:
          type: string
          description: Certificate Owner
        certificateType:
          type: string
          description: Certificate type
          enum:
          - X509
          - SSH
        issuerSerialNumber:
          type: string
          description: Serial number of the issuer
        certificateValidationResult:
          type: object
          additionalProperties:
            $ref: '#/components/schemas/CertificateValidationDto'
          description: Certificate validation result
      description: Administrator Certificate Details
    CertificateEntityDto:
      required:
      - entityType
      - name
      - uuid
      type: object
      properties:
        uuid:
          type: string
          description: Object identifier
        name:
          type: string
          description: Object Name
        description:
          type: string
          description: Description of the Entity
        entityType:
          type: string
          description: Type of the Entity
          enum:
          - SERVER
          - ROUTER
          - HSM
          - SWITCH
          - LOAD_BALANCER
          - FIREWALL
          - MDM
          - CLOUD
      description: Entity associated to the Certificate
    CertificateGroupDto:
      required:
      - name
      - uuid
      type: object
      properties:
        uuid:
          type: string
          description: Object identifier
        name:
          type: string
          description: Object Name
        description:
          type: string
          description: Description of the Certificate Group
      description: Group associated to the Certificate
    CertificateValidationDto:
      type: object
      properties:
        status:
          type: string
          enum:
          - SUCCESS
          - FAILED
          - WARNING
          - REVOKED
          - NOT_CHECKED
          - INVALID
          - EXPIRING
          - EXPIRED
        message:
          type: string
      description: Certificate validation result
    RaProfileDto:
      required:
      - attributes
      - authorityInstanceName
      - authorityInstanceUuid
      - enabled
      - name
      - uuid
      type: object
      properties:
        uuid:
          type: string
          description: Object identifier
        name:
          type: string
          description: Object Name
        description:
          type: string
          description: Description of RA Profile
        authorityInstanceUuid:
          type: string
          description: UUID of Authority provider
        authorityInstanceName:
          type: string
          description: Name of Authority instance
        attributes:
          type: array
          description: List of RA Profiles attributes
          items:
            $ref: '#/components/schemas/AttributeDefinition'
        enabled:
          type: boolean
          description: Enabled flag - true = enabled; false = disabled
      description: RA Profile associated to the Certificate
    AddAdminRequestDto:
      required:
      - description
      - email
      - enabled
      - name
      - role
      - surname
      - username
      type: object
      properties:
        adminCertificate:
          type: string
          description: Base64 Content of the admin certificate
        certificateUuid:
          type: string
          description: UUID of the existing certificate in the Inventory
        username:
          type: string
          description: Username of the administrator
        name:
          type: string
          description: Name of the administrator
        surname:
          type: string
          description: Surname of the administrator
        email:
          type: string
          description: Email of the administrator
        role:
          type: string
          description: Role of the administrator
          enum:
          - ADMINISTRATOR
          - SUPERADMINISTRATOR
        enabled:
          type: boolean
          description: "Enabled flag. true = enabled, false = disabled"
        description:
          type: string
          description: Description for the administrator
    ValidationError:
      type: object
      properties:
        errorDescription:
          type: string
    ValidationException:
      type: object
      properties:
        cause:
          type: object
          properties:
            stackTrace:
              type: array
              items:
                type: object
                properties:
                  classLoaderName:
                    type: string
                  moduleName:
                    type: string
                  moduleVersion:
                    type: string
                  methodName:
                    type: string
                  fileName:
                    type: string
                  lineNumber:
                    type: integer
                    format: int32
                  className:
                    type: string
                  nativeMethod:
                    type: boolean
            message:
              type: string
            suppressed:
              type: array
              items:
                type: object
                properties:
                  stackTrace:
                    type: array
                    items:
                      type: object
                      properties:
                        classLoaderName:
                          type: string
                        moduleName:
                          type: string
                        moduleVersion:
                          type: string
                        methodName:
                          type: string
                        fileName:
                          type: string
                        lineNumber:
                          type: integer
                          format: int32
                        className:
                          type: string
                        nativeMethod:
                          type: boolean
                  message:
                    type: string
                  localizedMessage:
                    type: string
            localizedMessage:
              type: string
        stackTrace:
          type: array
          items:
            type: object
            properties:
              classLoaderName:
                type: string
              moduleName:
                type: string
              moduleVersion:
                type: string
              methodName:
                type: string
              fileName:
                type: string
              lineNumber:
                type: integer
                format: int32
              className:
                type: string
              nativeMethod:
                type: boolean
        errors:
          type: array
          items:
            $ref: '#/components/schemas/ValidationError'
        message:
          type: string
        suppressed:
          type: array
          items:
            type: object
            properties:
              stackTrace:
                type: array
                items:
                  type: object
                  properties:
                    classLoaderName:
                      type: string
                    moduleName:
                      type: string
                    moduleVersion:
                      type: string
                    methodName:
                      type: string
                    fileName:
                      type: string
                    lineNumber:
                      type: integer
                      format: int32
                    className:
                      type: string
                    nativeMethod:
                      type: boolean
              message:
                type: string
              localizedMessage:
                type: string
        localizedMessage:
          type: string
